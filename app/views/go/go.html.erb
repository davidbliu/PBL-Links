

<script type = 'text/javascript'>
function pullEventCatalogue(option){
	// pull data from /go/catalogue
	$.ajax({
      url: '/go/catalogue',
      type: 'GET',
      data: {'option': option},
      success:function(data){
        $('#catalogue-container').html(data);
      },
      error:function (xhr, textStatus, thrownError){
        $('#catalogue-container').html('<h1>Failed to load link catalogue</h1>');
      }
  	});
}
function pullTrendingLinks(option){
  // pull data from /go/catalogue
  $.ajax({
      url: '/go/catalogue',
      type: 'GET',
      data: {'option': option},
      success:function(data){
        $('#trending-container').html(data);
      },
      error:function (xhr, textStatus, thrownError){
        $('#trending-container').html('<h1>Failed to load trending links</h1>');
      }
    });
}
function activateButtonActions(){
	$('.catalogue-btn').click(function(){
		$('.catalogue-btn.active').each(function(){
			$(this).removeClass('active');
		});
		$(this).addClass('active');
		// refresh event catalogue
		option = $(this).attr('id');
		$('#catalogue-container').html("");
		pullEventCatalogue(option);
	});
}
function activateSearchButton(){
  $('#search-btn').click(function(){
    search_term = $('#search-input').val();
    window.location.assign('/go?search_term='+search_term);
  });

  $('#search-input').keypress(function(e) {
    if(e.which == 13) {
       search_term = $('#search-input').val();
       window.location.assign('/go?search_term='+search_term);
    }
});
}
$(document).ready(function(){
	pullEventCatalogue('');
  pullTrendingLinks('trending');
	activateButtonActions();
  activateSearchButton();
});
</script>

<style type = 'text/css'>
#catalogue-container{
	margin-top:25px;
}
#catalogue-button-container{
	margin-top: 25px;
}
</style>

<style type = 'text/css'>
#custom-search-input{
    padding: 3px;
    border: solid 1px #E4E4E4;
    border-radius: 6px;
    background-color: #fff;
}

#custom-search-input input{
    border: 0;
    box-shadow: none;
}

#custom-search-input button{
    margin: 0px 0 0 0;
    background: none;
    box-shadow: none;
    border: 0;
    /*color: #666666;*/
    color: white;
    background-color:#1976d2;
    padding: 10 8px 10 10px;
    /*border-left: solid 1px #ccc;*/
}

#custom-search-input button:hover{
    border: 0;
    box-shadow: none;
    border-left: solid 1px #ccc;
}

#custom-search-input .glyphicon-search {
  font-size: 23px;
  padding: 5px 20px 5px 20px;
}

#search-btn:hover{
  color:white;
  background-color:black;
}
#search-btn{
  background-color:#1976d2;
  color:white;
  padding:3px;
}
</style>

<style type = 'text/css'>
.form-control {
  border: 0;
  background-image: linear-gradient(#000000, #000000),linear-gradient(#d2d2d2,#d2d2d2);
  background-size: 0 2px,100% 1px;
  background-repeat: no-repeat;
  background-position: center bottom,center calc(100% - 1px);
  background-color: transparent;
}
.add-link{
  text-decoration:none;
  color:white;
}
.add-link:hover{
  text-decoration:none;
  color:white;
}
</style>
<% if @message %>
<p><%= @message %></p>
<% end %>

<div style = 'margin-bottom:15px'>
<a href = '/go/manage' class = 'add-link' ><button class = 'btn btn-material-red-700 btn-raised'>New</button></a>
<!-- <div><%= link_to 'PBL Link Guide', '/go/guide' %></div> -->
</div>

<div id="custom-search-input">
                <div class="input-group col-md-12">
                    <input id = 'search-input' type="text" class="input-lg" placeholder="Search for a PBL link" />
                    <span class="input-group-btn">
                        <button id = 'search-btn' class="btn btn-info btn-lg btn-raised" type="button">
                            <span id = 'search-icon' class="glyphicon glyphicon-search btn-raised"></span>
                        </button>
                    </span>
                </div>
            </div>


<% if @search_results %>
  <h3>Search Results for "<%= @search_term %>" (<%= @search_results.to_a.length %> Results)</h3>
  <% @search_results.each_with_index do |result, index| %>
  <div><b>Result <%= index+1 %></b></div>
  <p>
    <div>score: <%= result._score %></div>
    <div>key: <a href = '/go/<%= result._source['parse_id'] %>/edit'><%= result._source['key'] %></a></div>
    <div>url: <a href = '<%= result._source['url'] %>'><%= result._source['url'] %></a></div>
    <div>description: <%= result._source['description'] %></div>
  <p>
  <% end %>
  <% end %>

  <h3>Trending</h3>
  <div id = 'trending-container'></div>
  <h3>All Links (<%= @num_links %>)</h3>


<!-- <h1>PBL Link Catalogue</h1> -->

<!-- Single button -->
<!-- <div class="btn-group"> -->
  <!-- <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"> -->
    <!-- Filtering Options <span class="caret"></span> -->
  <!-- </button> -->
  <!-- <ul class="dropdown-menu"> -->
  	<!-- <li><a id = '' class = 'catalogue-btn'>Alphabetical</a></li> -->
    <!-- <li><a id = 'resource-type' class = 'catalogue-btn'>By Link Type</a></li> -->
    <!-- <li><a id = 'prefix-suffix' class = 'catalogue-btn'>By Link Keywords</a></li> -->
    <!-- <li><a id = 'metrics' class = 'catalogue-btn'>Metrics</a></li> -->
  <!-- </ul> -->
<!-- </div> -->

<!-- <div id = 'catalogue-button-container'>
<a class="btn btn-default" href="/go/clicks" role="button">Metrics</a>
<button id = "" class="catalogue-btn btn btn-default active" type="submit">Alphabetical</button>
<button id = "resource-type" class="catalogue-btn btn btn-default" type="submit">Group By Resource Type</button>
<button id = 'prefix-suffix' class="catalogue-btn btn btn-default" type="submit">Group By Prefix/Suffix</button>
</div> -->

<div id = 'catalogue-container'></div>

